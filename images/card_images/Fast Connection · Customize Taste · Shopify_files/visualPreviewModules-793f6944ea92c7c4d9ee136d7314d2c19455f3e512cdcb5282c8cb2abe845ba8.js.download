(self.webpackChunk_ShopifyEditorModules=self.webpackChunk_ShopifyEditorModules||[]).push([["visualPreviewModules"],{"./packages/@editor/storefront-controller/async-modules/user-interface/components/GlobalContext/GlobalContext.tsx":(e,t,n)=>{"use strict";n.d(t,{k:()=>r});const r=(0,n("./node_modules/preact/compat/dist/compat.module.js").kr)({})},"./packages/@editor/storefront-controller/async-modules/user-interface/components/InterfaceRoot/InterfaceRoot.tsx":(e,t,n)=>{"use strict";n.d(t,{m:()=>i,v:()=>a});var r=n("./node_modules/preact/compat/dist/compat.module.js"),o=n("./packages/@editor/storefront-controller/async-modules/user-interface/utilities/custom-elements.ts"),s=n("./node_modules/preact/compat/jsx-runtime.mjs");class i extends HTMLElement{constructor(){super()}connectedCallback(){"true"===this.getAttribute("shadow-dom")&&this.attachShadow({mode:"open"})}}i.tagName="shopify-editor-interface";const c={all:"initial"};function a({children:e,shadowDOM:t}){const[n,o]=(0,r.eJ)(null),a=t&&null!=n&&n.shadowRoot?(0,r.jz)(e,n.shadowRoot):null,u=(0,r.az)(i.tagName,{style:t?c:void 0,ref:o,"shadow-dom":t},t?null:e);return(0,s.BX)(s.HY,{children:[u,a]})}(0,o.z)(i)},"./packages/@editor/storefront-controller/async-modules/user-interface/types.ts":(e,t,n)=>{"use strict";n.d(t,{M:()=>r});let r=function(e){return e.RemoteHost="shopify-editor",e}({})},"./packages/@editor/storefront-controller/async-modules/user-interface/user-interface.ts":(e,t,n)=>{"use strict";n.d(t,{E:()=>k});var r=n("./packages/@editor/storefront-controller/modules/utilities/domain.ts");let o=function(e){return e.RemoteInitialize="RemoteUI::Initialize",e.HostReady="RemoteUI::Host::Ready",e}({});var s=n("./packages/@editor/storefront-controller/modules/utilities/emit-event.ts"),i=n("./node_modules/preact/compat/dist/compat.module.js"),c=n("./packages/@editor/storefront-controller/async-modules/user-interface/types.ts"),a=n("./packages/@editor/storefront-controller/async-modules/user-interface/utilities/custom-elements.ts");class u extends HTMLElement{}u.tagName=c.M.RemoteHost,u.create=()=>document.createElement(u.tagName),(0,a.z)(u);var l=n("./packages/@editor/storefront-controller/async-modules/user-interface/components/GlobalContext/GlobalContext.tsx"),d=n("./node_modules/@remote-ui/core/build/esnext/receiver.esnext"),m=n("./node_modules/@remote-ui/rpc/build/esnext/endpoint.esnext"),f=n("./node_modules/@remote-ui/rpc/build/esnext/adaptors/message-port.esnext"),p=n("./node_modules/@remote-ui/react/build/esnext/host/controller.esnext"),h=n("./node_modules/@remote-ui/react/build/esnext/host/RemoteRenderer.esnext"),v=n("./node_modules/preact/compat/jsx-runtime.mjs");function y({components:e,onTeardown:t,port:n}){const r=(0,i.Ye)((()=>(0,p.E)(e)),[e]),[o]=(0,i.eJ)(d.EX);return(0,i.d4)((()=>{(0,m.dg)((0,f.E)(n)).expose({initialize:()=>o.receive,teardown:t}),n.start()}),[n,o,t]),(0,v.tZ)(h.K,{receiver:o,controller:r})}var w=n("./packages/@editor/storefront-controller/async-modules/user-interface/components/InterfaceRoot/InterfaceRoot.tsx");let g=null;function k(e){try{var t;if(window.__shopify_internal_sfm_ui)return;window.__shopify_internal_sfm_ui=!0,window.addEventListener("message",(t=>{if(t.origin===(0,r.kY)())switch(t.data){case o.RemoteInitialize:{const[n]=t.ports;if(!n)return;!function(e,t){g||(g=u.create()),document.querySelector(u.tagName)||document.body.appendChild(g);const n={rootElement:g};(0,i.sY)((0,v.tZ)(l.k.Provider,{value:n,children:(0,v.tZ)(y,{onTeardown:function(){g&&((0,i.uy)(g),g.remove(),g=null)},components:{...t,InterfaceRoot:w.v},port:e})}),g)}(n,e.components);break}}})),window.parent.postMessage({type:o.HostReady,version:null===(t=window)||void 0===t?void 0:t.name},(0,r.kY)())}catch(n){(0,s.K)("StorefrontEvent::Error",{errorMessage:n.message,stackTrace:n.stack})}}},"./packages/@editor/storefront-controller/async-modules/user-interface/utilities/custom-elements.ts":(e,t,n)=>{"use strict";function r(e){customElements.get(e.tagName)||customElements.define(e.tagName,e)}n.d(t,{z:()=>r})},"./packages/@editor/storefront-controller/hooks/useResizeObserver.ts":(e,t,n)=>{"use strict";n.d(t,{y:()=>o});var r=n("./node_modules/preact/compat/dist/compat.module.js");function o({element:e,onResize:t}){const n=(0,r.sO)(null),o=(0,r.sO)({element:null,onResize:t}),s=(0,r.I4)((()=>{n.current&&cancelAnimationFrame(n.current),n.current=requestAnimationFrame((()=>{const{element:e,onResize:t}=o.current;e&&(null==t||t(e))}))}),[]),[i]=(0,r.eJ)((()=>new ResizeObserver(s)));(0,r.bt)((()=>{const t=o.current.element;e!==t&&(t&&i.unobserve(t),e&&i.observe(e),o.current.element=e)}),[e,t,i]),(0,r.d4)((function(){return()=>i.disconnect()}),[i])}},"./packages/@editor/storefront-controller/modules/theme-api/theme-api.ts":(e,t,n)=>{"use strict";function r({type:e,target:t,data:n}){(function(e,t,n={}){const r=document.createEvent("Event");r.detail=n.data,null==n.event&&(n.event={}),null==n.bubbles&&(n.bubbles=!0),null==n.cancelable&&(n.cancelable=!0),Object.keys(n.event||{}).forEach((e=>{r[e]=n.event[e]})),r.initEvent(t,n.bubbles,n.cancelable),e.dispatchEvent(r)})(t,`shopify:${e}`,n?{data:n}:void 0)}function o(e){console.warn(e)}n.d(t,{qf:()=>r,KE:()=>o})},"./packages/@editor/storefront-controller/modules/utilities/domain.ts":(e,t,n)=>{"use strict";n.d(t,{kY:()=>o,w7:()=>s});var r=n("./packages/@editor/storefront-controller/modules/utilities/globals.ts");function o(){return`https://${function(){const e=(0,r.er)();if(null==e)throw new Error("Shopify object is missing");return e.editorDomain}()}`}function s(){const e=(0,r.er)();if(null==e)throw new Error("Shopify object is missing");return e.shop}},"./packages/@editor/storefront-controller/modules/utilities/emit-event.ts":(e,t,n)=>{"use strict";n.d(t,{K:()=>s});var r=n("./packages/@editor/storefront-controller/modules/utilities/globals.ts"),o=n("./packages/@editor/storefront-controller/modules/utilities/domain.ts");function s(e,t){(0,r.YM)().parent.postMessage({type:e,payload:t},(0,o.kY)())}},"./packages/@editor/storefront-controller/modules/utilities/fetchAssets.ts":(e,t,n)=>{"use strict";n.d(t,{Dl:()=>c,V6:()=>s,ff:()=>i,sj:()=>o});var r=n("./node_modules/qs/lib/index.js");async function o(e){const t=`${window.location.pathname}${window.location.search}`;return(await c(t,e)).json()}async function s(e){const t=`${window.location.pathname}${window.location.search}`;return(await c(t,e)).json()}async function i(e,t){try{const n=await c(e,t);return{content:await n.text()}}catch(n){return{error:n}}}function c(e,t){return fetch(e,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:(0,r.stringify)({_method:"get",...t},{arrayFormat:"brackets"})})}},"./packages/@editor/storefront-controller/modules/utilities/globals.ts":(e,t,n)=>{"use strict";function r(){return s}n.d(t,{WN:()=>c,YM:()=>r,er:()=>i});const o=window.Shopify,s={parent:window.parent,Shopify:o&&{...o}};function i(){return r().Shopify}function c(e){return"Shopify"in e}},"./packages/@editor/visual-preview/modules/index.ts":(e,t,n)=>{"use strict";n.r(t),n.d(t,{initialize:()=>x});var r=n("./packages/@editor/storefront-controller/async-modules/user-interface/user-interface.ts"),o=n("./packages/@editor/storefront-controller/async-modules/user-interface/types.ts"),s=n("./packages/@editor/storefront-controller/modules/utilities/globals.ts"),i=n("./node_modules/preact/compat/dist/compat.module.js"),c=n("./packages/@editor/storefront-controller/modules/utilities/emit-event.ts");function a(e,t,n){var r=this,o=(0,i.sO)(null),s=(0,i.sO)(0),c=(0,i.sO)(null),a=(0,i.sO)([]),u=(0,i.sO)(),l=(0,i.sO)(),d=(0,i.sO)(e),m=(0,i.sO)(!0);(0,i.d4)((function(){d.current=e}),[e]);var f=!t&&0!==t&&"undefined"!=typeof window;if("function"!=typeof e)throw new TypeError("Expected a function");t=+t||0;var p=!!(n=n||{}).leading,h=!("trailing"in n)||!!n.trailing,v="maxWait"in n,y=v?Math.max(+n.maxWait||0,t):null;(0,i.d4)((function(){return m.current=!0,function(){m.current=!1}}),[]);var w=(0,i.Ye)((function(){var e=function(e){var t=a.current,n=u.current;return a.current=u.current=null,s.current=e,l.current=d.current.apply(n,t)},n=function(e,t){f&&cancelAnimationFrame(c.current),c.current=f?requestAnimationFrame(e):setTimeout(e,t)},i=function(e){if(!m.current)return!1;var n=e-o.current;return!o.current||n>=t||n<0||v&&e-s.current>=y},w=function(t){return c.current=null,h&&a.current?e(t):(a.current=u.current=null,l.current)},g=function e(){var r=Date.now();if(i(r))return w(r);if(m.current){var c=t-(r-o.current),a=v?Math.min(c,y-(r-s.current)):c;n(e,a)}},k=function(){var d=Date.now(),f=i(d);if(a.current=[].slice.call(arguments),u.current=r,o.current=d,f){if(!c.current&&m.current)return s.current=o.current,n(g,t),p?e(o.current):l.current;if(v)return n(g,t),e(o.current)}return c.current||n(g,t),l.current};return k.cancel=function(){c.current&&(f?cancelAnimationFrame(c.current):clearTimeout(c.current)),s.current=0,a.current=o.current=u.current=c.current=null},k.isPending=function(){return!!c.current},k.flush=function(){return c.current?w(Date.now()):l.current},k}),[p,v,t,y,h,f]);return w}var u=n("./packages/@editor/storefront-controller/async-modules/user-interface/utilities/custom-elements.ts"),l=n("./packages/@editor/storefront-controller/modules/utilities/fetchAssets.ts");const d="source";function m(e,t=1,n=5){if(t>n)return!1;const r=getComputedStyle(e);if(0===parseFloat(r.height)-parseFloat(r.paddingTop)-parseFloat(r.paddingBottom))return!0;for(const o of e.children)if(!m(o,t+1,n))return!1;return!0}var f=n("./packages/@editor/storefront-controller/hooks/useResizeObserver.ts");function p({activeId:e,containerRef:t,onUpdate:n}){const r=(0,i.I4)((e=>{const t=m(e);n(t?0:(e=>Math.round(e.getBoundingClientRect().height))(e))}),[n]);(0,f.y)({element:t.current,onResize:r}),function(e,t){const n=i.ZP.useRef(e);(0,i.d4)((()=>{const r=n.current;e!==n.current&&(n.current=e,t(e,r))}),[e,t])}(e,((e,n)=>{e!==n&&t.current&&r(t.current)}))}var h=n("./packages/@editor/storefront-controller/modules/theme-api/theme-api.ts");class v extends HTMLElement{}v.tagName="shopify-visual-preview-section-list-item";const y=({id:e,children:t})=>{const n=(0,i.sO)(null),r=(0,i.sO)(e),[o,s]=(0,i.eJ)(!1);if((0,i.d4)((()=>{var t;const r=null===(t=n.current)||void 0===t?void 0:t.firstChild;r&&e&&(0,h.qf)({type:"section:load",target:r,data:{sectionId:e}})}),[e]),(0,i.Ye)((()=>{var t;const o=null===(t=n.current)||void 0===t?void 0:t.firstChild,s=r.current;r.current=e,o&&s&&(0,h.qf)({type:"section:unload",target:o,data:{sectionId:s}})}),[e]),(0,i.bt)((()=>{var e;const t=null===(e=n.current)||void 0===e?void 0:e.querySelectorAll('link[rel="stylesheet"]');if(!t)return;s(!0);const r=Array.from(t).map((e=>new Promise(((t,n)=>{e.addEventListener("load",t),e.addEventListener("error",n)}))));Promise.all(r).finally((()=>{s(!1)})).catch((()=>{}))}),[t]),!e)return null;const c={transition:o?"none":"opacity 100ms cubic-bezier(0.25, 0.1, 0.25, 1)",opacity:o?0:1};return(0,i.az)(v.tagName,{dangerouslySetInnerHTML:{__html:t},ref:n,style:c})};(0,u.z)(v);var w=n("./node_modules/preact/compat/jsx-runtime.mjs");class g extends HTMLElement{}g.tagName="shopify-visual-preview-section-list";const k={display:"inline-block",width:"100%",padding:"16px"},b=250;function _({presets:e,sharedSections:t,activeId:n,onUpdate:r,onInitialize:o}){var s;const[u,m]=(0,i.eJ)({}),f=a((async e=>{const t=e.filter((e=>!(null!=u&&u[e.uniqueId])));if(t.length)try{const e=await async function(e){try{const t=new URL(window.location.href);t.searchParams.set(d,"visualPreview");const n=await(0,l.Dl)(t.toString(),{render_sections:e.reduce(((e,t)=>({...e,[t.uniqueId]:JSON.stringify({templateSection:{type:t.section.schema.type,presetIndex:parseInt((null==t?void 0:t.presetIndex)||"0",10)}})})),{}),unconfirmed_sections:!0});return(await n.json()).sections}catch(t){throw new Error("Failed to fetch section assets")}}(t);m((t=>({...t,...e}))),o()}catch(n){o(n),(0,c.K)("StorefrontEvent::Error",{errorMessage:n.message,stackTrace:n.stack})}}),b),h=a((async e=>{if(null==e)return;const t=e.filter((e=>!(null!=u&&u[e.sectionId])));if(0!==t.length)try{const e=await async function(e){try{const t=new URL(window.location.href);t.searchParams.set(d,"visualPreview");const n=e.reduce(((e,t)=>({...e,[t.sectionId]:JSON.stringify({templateSection:t})})),{}),r=await(0,l.Dl)(t.toString(),{render_sections:n,unconfirmed_sections:!0});return(await r.json()).sections}catch(t){throw new Error("Failed to fetch section assets")}}(t);m((t=>({...t,...e}))),o()}catch(n){o(n),(0,c.K)("StorefrontEvent::Error",{errorMessage:n.message,stackTrace:n.stack})}}),b),v=(0,i.sO)(null);return p({activeId:n,containerRef:v,onUpdate:r}),(0,i.d4)((()=>{f(e)}),[e,f,o]),(0,i.d4)((()=>{h(t)}),[t,h,o]),(0,i.az)(g.tagName,{style:k,ref:v},n?(0,w.tZ)(y,{id:n,children:null===(s=u[n])||void 0===s?void 0:s.html}):null)}function x(){!function(){document.documentElement.style.overflow="hidden";const e=document.createElement("style");e.innerHTML=`\n  body > *:not(${o.M.RemoteHost}) {\n    display: none !important;\n  }\n  `,document.body.appendChild(e)}(),(0,s.WN)(window)&&(window.Shopify.visualPreviewMode=!0),(0,r.E)({components:{SectionList:_}})}(0,u.z)(g),window.addEventListener("load",x)},"?09cc":()=>{}},e=>{e.O(0,["vendors-node_modules_qs_lib_index_js","vendors-node_modules_remote-ui_react_build_esnext_host_RemoteRenderer_esnext-node_modules_rem-ac0a96"],(()=>{return t="./packages/@editor/visual-preview/modules/index.ts",e(e.s=t);var t}));var t=e.O();_ShopifyEditorModules=t}]);